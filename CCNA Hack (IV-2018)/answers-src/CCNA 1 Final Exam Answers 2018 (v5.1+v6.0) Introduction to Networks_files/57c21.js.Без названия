;(function(window,document,$){'use strict';var cache={filterId:0},$body=$('body');var Vague=function(elm,customOptions){var defaultOptions={intensity:5,forceSVGUrl:false,animationOptions:{duration:1000,easing:'linear'}},options=$.extend(defaultOptions,customOptions),_browserPrefixes=' -webkit- -moz- -o- -ms- '.split(' '),_cssPrefixString={},_cssPrefix=function(property){if(_cssPrefixString[property]||_cssPrefixString[property]===''){return _cssPrefixString[property]+property;}
var e=document.createElement('div');var prefixes=['','Moz','Webkit','O','ms','Khtml'];for(var i in prefixes){if(typeof e.style[prefixes[i]+property]!=='undefined'){_cssPrefixString[property]=prefixes[i];return prefixes[i]+property;}}
return property.toLowerCase();},_support={cssfilters:function(){var el=document.createElement('div');el.style.cssText=_browserPrefixes.join('filter'+':blur(2px); ');return!!el.style.length&&((document.documentMode===undefined||document.documentMode>9));}(),svgfilters:function(){var result=false;try{result=typeof SVGFEColorMatrixElement!==undefined&&SVGFEColorMatrixElement.SVG_FECOLORMATRIX_TYPE_SATURATE==2;}catch(e){}
return result;}()},_blurred=false,_cssFilterProp=_cssPrefix('Filter'),_svgGaussianFilter,_filterId,_animation,_createSvgElement=function(tagName){return document.createElementNS('http://www.w3.org/2000/svg',tagName);},_appendSVGFilter=function(){var svg=_createSvgElement('svg'),filter=_createSvgElement('filter');_svgGaussianFilter=_createSvgElement('feGaussianBlur');svg.setAttribute('style','position:absolute');svg.setAttribute('width','0');svg.setAttribute('height','0');filter.setAttribute('id','blur-effect-id-'+cache.filterId);filter.appendChild(_svgGaussianFilter);svg.appendChild(filter);$body.append(svg);};this.$elm=elm instanceof $?elm:$(elm);this.init=function(){if(_support.svgfilters){_appendSVGFilter();}
_filterId=cache.filterId;cache.filterId++;return this;};this.blur=function(){var cssFilterValue,loc=window.location,svgUrl=options.forceSVGUrl?loc.protocol+'//'+loc.host+loc.pathname+loc.search:'';if(_support.cssfilters){cssFilterValue='blur('+options.intensity+'px)';}else if(_support.svgfilters){_svgGaussianFilter.setAttribute('stdDeviation',options.intensity);cssFilterValue='url('+svgUrl+'#blur-effect-id-'+_filterId+')';}else{cssFilterValue='progid:DXImageTransform.Microsoft.Blur(pixelradius='+options.intensity+')';}
this.$elm[0].style[_cssFilterProp]=cssFilterValue;_blurred=true;return this;};this.animate=function(newIntensity,customAnimationOptions){if(typeof newIntensity!=='number'){throw(typeof newIntensity+' is not a valid number to animate the blur');}else if(newIntensity<0){throw('I can animate only positive numbers');}
var dfr=new $.Deferred();if(_animation){_animation.stop(true,true);}
_animation=new $.Animation(options,{intensity:newIntensity},$.extend(options.animationOptions,customAnimationOptions)).progress($.proxy(this.blur,this)).done(dfr.resolve);return dfr.promise();};this.unblur=function(){this.$elm.css(_cssFilterProp,'none');_blurred=false;return this;};this.toggleblur=function(){if(_blurred){this.unblur();}else{this.blur();}
return this;};this.destroy=function(){if(_support.svgfilters){$('filter#blur-effect-id-'+_filterId).parent().remove();}
this.unblur();for(var prop in this){delete this[prop];}
return this;};this.supports=_support;return this.init();}
$.fn.Vague=function(options){return new Vague(this,options);};}(window,document,jQuery));