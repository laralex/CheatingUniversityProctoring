var essb_handle_stats=function(oService,oPostID,oInstance){var element=jQuery('.essb_'+oInstance);var instance_postion=jQuery(element).attr("data-essb-position")||"";var instance_template=jQuery(element).attr("data-essb-template")||"";var instance_button=jQuery(element).attr("data-essb-button-style")||"";var instance_counters=jQuery(element).hasClass("essb_counters")?true:false;var instance_nostats=jQuery(element).hasClass("essb_nostats")?true:false;if(instance_nostats){return;}var instance_mobile=false;if((/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i).test(navigator.userAgent)){instance_mobile=true;}if(typeof(essb_settings)!="undefined"){jQuery.post(essb_settings.ajax_url,{'action':'essb_stat_log','post_id':oPostID,'service':oService,'template':instance_template,'mobile':instance_mobile,'position':instance_postion,'button':instance_button,'counter':instance_counters,'nonce':essb_settings.essb3_nonce},function(data){if(data){}},'json');}};var essb_mailform_opened=false;function essb_open_mailform(unique_id){jQuery.fn.extend({center:function(){return this.each(function(){var top=(jQuery(window).height()-jQuery(this).outerHeight())/2;var left=(jQuery(window).width()-jQuery(this).outerWidth())/2;jQuery(this).css({position:'fixed',margin:0,top:(top>0?top:0)+'px',left:(left>0?left:0)+'px'});});}});if(essb_mailform_opened){essb_close_mailform(unique_id);return;}var sender_element=jQuery(".essb_"+unique_id);if(!sender_element.length)return;var sender_post_id=jQuery(sender_element).attr("data-essb-postid")||"";jQuery("#essb_mail_instance").val(unique_id);jQuery("#essb_mail_post").val(sender_post_id);var win_width=jQuery(window).width();var win_height=jQuery(window).height();var doc_height=jQuery('document').height();var base_width=300;if(win_width<base_width){base_width=win_width-30;}var height_correction=20;var element_class=".essb_mailform";var element_class_shadow=".essb_mailform_shadow";jQuery(element_class).css({width:base_width+'px'});var popup_height=jQuery(element_class).outerHeight();if(popup_height>(win_height-30)){jQuery(element_class).css({height:(win_height-height_correction)+'px'});}jQuery("#essb_mailform_from").val("");jQuery("#essb_mailform_to").val("");if(jQuery("#essb_mailform_c").length)jQuery("#essb_mailform_c").val("");jQuery(element_class_shadow).css({height:(win_height)+'px'});jQuery(element_class).center();jQuery(element_class).slideDown(200);jQuery(element_class_shadow).fadeIn(200);essb_mailform_opened=true;essb.tracking_only("","mail",unique_id);};function essb_close_mailform(){var element_class=".essb_mailform";var element_class_shadow=".essb_mailform_shadow";jQuery(element_class).fadeOut(200);jQuery(element_class_shadow).fadeOut(200);essb_mailform_opened=false;};function essb_mailform_send(){var sender_email=jQuery("#essb_mailform_from").val();var recepient_email=jQuery("#essb_mailform_to").val();var captcha_validate=jQuery("#essb_mailform_c").length?true:false;var captcha=captcha_validate?jQuery("#essb_mailform_c").val():"";var custom_message=jQuery("#essb_mailform_custom").length?jQuery("#essb_mailform_custom").val():"";if(sender_email==""||recepient_email==""||(captcha==""&&captcha_validate)){alert("Please fill all fields in form!");return;}var mail_salt=jQuery("#essb_mail_salt").val();var instance_post_id=jQuery("#essb_mail_post").val();console.log("mail salt = "+mail_salt);if(typeof(essb_settings)!="undefined"){jQuery.post(essb_settings.ajax_url,{"action":"essb_mail_action","post_id":instance_post_id,"from":sender_email,"to":recepient_email,"c":captcha,"cu":custom_message,"salt":mail_salt,"nonce":essb_settings.essb3_nonce},function(data){if(data){console.log(data);alert(data["message"]);if(data["code"]=="1")essb_close_mailform();}},'json');}};