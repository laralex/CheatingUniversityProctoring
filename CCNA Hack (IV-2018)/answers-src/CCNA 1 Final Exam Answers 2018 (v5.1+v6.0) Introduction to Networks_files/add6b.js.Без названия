jQuery(document).ready(function($){var status='';var ajaxData='';var commentID=0;var comment='';var commentAuthor='';var currentObject='';var message='';var subject='';var moveToPost='';var femXHR=0;var parentID='';var lastCommentID='';function ajaxFunction(data){var ajaxObj=$.ajax({type:'POST',url:wpdiscuzAjaxObj.url,data:data});return ajaxObj;}
function getVariables(currentObject,status){var response=[];response[0]=currentObject.parents('div[id^=comment-]').attr('id');if(''===status){response[1]='';}else if('delete'===status){response[1]=confirm(wpdiscuzAjaxObj.wpdiscuz_options.confirm_delete+'?');}else if('blacklist'===status){response[1]=confirm(wpdiscuzAjaxObj.wpdiscuz_options.confirm_blacklist+'?');}else{response[1]=confirm(wpdiscuzAjaxObj.wpdiscuz_options.confirm+' '+status+'?');}
response[2]=parseInt(response[0].substring(response[0].lastIndexOf('-')+1));return response;}
function ajaxRequest(status,commentID,currentObject){$('.wpdiscuz-loading-bar').show();ajaxData={commentID:commentID,action:'wfem_moderate',status:status};var ajaxObj=ajaxFunction(ajaxData);ajaxObj.done(function(response){try{var obj=$.parseJSON(response);if(1===obj.code&&''===obj.message&&''!==obj.response&&''!==obj.status&&''!==obj.class){parentID=currentObject.parents('div[id^=wc-comm-'+commentID+']').attr('id');$('div[id='+parentID+']').find('.wpdiscuz-fem-moderation-buttons').empty();$('div[id='+parentID+']').find('.wpdiscuz-fem-moderation-buttons').html(obj.response);switch(status){case'approve':$('div[id='+parentID+']').removeClass('wc-unapproved');wpdiscuzAjaxObj.setCommentMessage(currentObject,obj.class,obj.status,false);$('div[id='+parentID+']').children('div[id^=comment-]').find('.wc_held_for_moderate').remove();break;case'hold':$('div[id='+parentID+']').addClass('wc-unapproved');wpdiscuzAjaxObj.setCommentMessage(currentObject,obj.class,obj.status,false);break;case'trash':$('div[id='+parentID+']').slideUp(1000,function(){$('div[id='+parentID+']').remove();});break;case'spam':$('div[id='+parentID+']').slideUp(1000,function(){$('div[id='+parentID+']').remove();});break;}}else if((0===obj.code||-1===obj.code)&&''!==obj.message&&''===obj.response&&''===obj.status&&''!==obj.class){wpdiscuzAjaxObj.setCommentMessage(currentObject,obj.class,obj.message,false);}
$('.wpdiscuz-loading-bar').hide();}catch(e){console.log(e);}});}
$('body').click(function(){$('.wpdiscuz-fem-moderation').removeClass('wpdiscuz-fem-show');$('#'+lastCommentID).css('margin-bottom','13px');});$(document).delegate('.wpdiscuz-fem-moderate-comment','click',function(){commentID=$(this).parents('div[id^=wc-comm-]').attr('id');$('+ .wpdiscuz-fem-moderation',this).addClass('wpdiscuz-fem-show');var windowHeight=$(window).height();var scrollTop=$(window).scrollTop();var elementOffset=$(this).offset().top;var distance=(elementOffset-scrollTop);var height=$('+ .wpdiscuz-fem-moderation',this).height();if(windowHeight-distance-height<0){$('+ .wpdiscuz-fem-moderation',this).css('top','-193px');height+=9;var heightNoBorder=height-2;$('+ .wpdiscuz-fem-moderation',this).children('.wpdiscuz-fem-arrow').css({'transform':'rotate(180deg) translateY(-'+height+'px)'});$('+ .wpdiscuz-fem-moderation',this).children('.wpdiscuz-fem-arrow-no-border').css({'transform':'rotate(180deg) translateY(-'+heightNoBorder+'px)'});}else{lastCommentID=$('.search-result').children('div[id^=wc-comm-]').last().attr('id')||$('#wcThreadWrapper').children('div[id^=wc-comm-]').last().attr('id');if(commentID===lastCommentID){$('#'+commentID).css('margin-bottom',height+'px');}
$('+ .wpdiscuz-fem-moderation',this).css('top','25px');$('+ .wpdiscuz-fem-moderation',this).children('.wpdiscuz-fem-arrow').css({'transform':'none','top':'-9px'});$('+ .wpdiscuz-fem-moderation',this).children('.wpdiscuz-fem-arrow-no-border').css({'transform':'none','top':'-8px'});}});$(document).delegate('.wpdiscuz-fem-button','click',function(){$(this).parents('.wpdiscuz-fem-moderation').removeClass('wpdiscuz-fem-show');});$('.wpdiscuz-fem-post').keyup(function(){var postsLike=$('.wpdiscuz-fem-post').val();if(femXHR!=0){femXHR.abort();femXHR=0;}
$('.wpdiscuz-loading-bar').hide();if(''!==postsLike&&postsLike.length>2){$('.wpdiscuz-loading-bar').show();ajaxData={commentPostID:wpdiscuzAjaxObj.wpdiscuz_options.wc_post_id,action:'wfem_post_titles',postsLike:postsLike};femXHR=ajaxFunction(ajaxData);femXHR.done(function(response){if(''!==response){$('.wpdiscuz-fem-posts').show();$('.wpdiscuz-fem-posts').empty();$('.wpdiscuz-fem-posts').append(response);}else{$('.wpdiscuz-fem-posts').hide();$('.wpdiscuz-fem-posts').empty();}
$('.wpdiscuz-loading-bar').hide();});}else{$('.wpdiscuz-fem-posts').hide();$('.wpdiscuz-fem-posts').empty();}});$(document).delegate('.wpdiscuz-fem-move-comment','click',function(){currentObject=$(this).parent();var variable=getVariables(currentObject,'');commentID=variable[2];var commentText=$(this).parents('div[id^=comment-]').find('.wc-comment-text p[class!=wc_held_for_moderate]').text();var comment=commentText.length<=200?commentText:commentText.substring(0,200)+'...';$('.wpdiscuz-fem-posts').hide();$('.wpdiscuz-fem-posts').empty();$('.wpdiscuz-fem-move-form').find('em').text(comment);$('.wpdiscuz-fem-moving').show();$('.wpdiscuz-fem-move-form').show();});$('.wpdiscuz-fem-move-form').click(function(){$('.wpdiscuz-fem-posts').hide();$('.wpdiscuz-fem-posts').empty();});$(document).delegate('div[id^=fem-post-]','click',function(){var current=$(this).attr('id');var text=$(this).text();moveToPost=parseInt(current.substring(current.lastIndexOf('-')+1));$('.wpdiscuz-fem-posts').hide();$('.wpdiscuz-fem-posts').empty();$('.wpdiscuz-fem-post').val(text);});$(document).delegate('.wpdiscuz-fem-move','click',function(){if(moveToPost){$('.wpdiscuz-fem-move-form').children('#wpdiscuz-fem-not').remove();$('.wpdiscuz-fem-posts').hide();$('.wpdiscuz-loading-bar').show();ajaxData={commentID:commentID,action:'wfem_move_comment',moveToPost:moveToPost};var ajaxObj=ajaxFunction(ajaxData);ajaxObj.done(function(response){try{var obj=$.parseJSON(response);if(1===obj.code&&''!==obj.message&&''!==obj.response&&''!==obj.class){$('#wpdiscuz-fem-not').remove();$('.wpdiscuz-fem-moving').show();$('.wpdiscuz-fem-move-form').hide();$('.wpdiscuz-fem-response').remove();$('.wpdiscuz-fem-moving').append(obj.response);parentID=currentObject.parents('div[id^=wc-comm-'+commentID+']').attr('id');$('div[id='+parentID+']').slideUp(1000,function(){$('div[id='+parentID+']').remove();});}else if((0===obj.code||-1===obj.code||-2===obj.code)&&''!==obj.message&&''!==obj.response&&''!==obj.class){$('#wpdiscuz-fem-not').remove();$('.wpdiscuz-fem-moving').show();$('.wpdiscuz-fem-move-form').hide();$('.wpdiscuz-fem-response').remove();$('.wpdiscuz-fem-moving').append(obj.response);wpdiscuzAjaxObj.setCommentMessage(currentObject,obj.class,obj.message,false);}
$('.wpdiscuz-loading-bar').hide();}catch(e){console.log(e);}});}else{$('.wpdiscuz-fem-move-form').children('#wpdiscuz-fem-not').remove();$('.wpdiscuz-fem-move-form').append('<div id="wpdiscuz-fem-not">Please choose post</div>');}});$(document).delegate('.wpdiscuz-fem-trash-comment','click',function(){currentObject=$(this).parent();var variable=getVariables(currentObject,wpdiscuzAjaxObj.wpdiscuz_options.trash);commentID=variable[2];if(true===variable[1]){ajaxRequest('trash',commentID,currentObject);}});$(document).delegate('.wpdiscuz-fem-unapprove-comment','click',function(){currentObject=$(this).parent();var variable=getVariables(currentObject,wpdiscuzAjaxObj.wpdiscuz_options.unapproved);commentID=variable[2];if(true===variable[1]){ajaxRequest('hold',commentID,currentObject);}});$(document).delegate('.wpdiscuz-fem-approve-comment','click',function(){currentObject=$(this).parent();var variable=getVariables(currentObject,wpdiscuzAjaxObj.wpdiscuz_options.approved);commentID=variable[2];if(true===variable[1]){ajaxRequest('approve',commentID,currentObject);}});$(document).delegate('.wpdiscuz-fem-spam-comment','click',function(){currentObject=$(this).parent();var variable=getVariables(currentObject,wpdiscuzAjaxObj.wpdiscuz_options.spam);commentID=variable[2];if(true===variable[1]){ajaxRequest('spam',commentID,currentObject);}});$(document).delegate('.wpdiscuz-fem-delete-comment, .wpdiscuz-fem-delete-comment-not-admin','click',function(){currentObject=$(this).parent();var variable=getVariables(currentObject,'delete');commentID=variable[2];if(true===variable[1]){$('.wpdiscuz-loading-bar').show();ajaxData={commentID:commentID,action:'wfem_delete',status:'delete'};var ajaxObj=ajaxFunction(ajaxData);ajaxObj.done(function(response){try{var obj=$.parseJSON(response);if(1===obj.code&&''===obj.message&&''!==obj.class){parentID=currentObject.parents('div[id^=wc-comm-'+commentID+']').attr('id');$('div[id='+parentID+']').slideUp(1000,function(){$('div[id='+parentID+']').remove();});}else if((0===obj.code||-1===obj.code)&&''!==obj.message&&''!==obj.class){wpdiscuzAjaxObj.setCommentMessage(currentObject,obj.class,obj.message,false);}
$('.wpdiscuz-loading-bar').hide();}catch(e){console.log(e);}});}});$(document).delegate('.wpdiscuz-fem-blacklist-comment','click',function(){currentObject=$(this).parent();var variable=getVariables(currentObject,'blacklist');commentID=variable[2];if(true===variable[1]){$('.wpdiscuz-loading-bar').show();ajaxData={commentID:commentID,action:'wfem_blacklist'};var ajaxObj=ajaxFunction(ajaxData);ajaxObj.done(function(response){try{var obj=$.parseJSON(response);if(1===obj.code&&''!==obj.message&&''!==obj.response&&''!==obj.class){parentID=currentObject.parents('div[id^=wc-comm-'+commentID+']').attr('id');$('div[id='+parentID+']').slideUp(1000,function(){$('div[id='+parentID+']').remove();});}else if((0===obj.code||-1===obj.code)&&''!==obj.message&&''===obj.response&&''!==obj.class){wpdiscuzAjaxObj.setCommentMessage(currentObject,obj.class,obj.message,false);}
$('.wpdiscuz-loading-bar').hide();}catch(e){console.log(e);}});}});$(document).delegate('.wpdiscuz-fem-email-comment','click',function(){currentObject=$(this).parent();var variable=getVariables(currentObject,'');commentID=variable[2];comment=$(this).parents('div[id^=comment-]').find('.wc-comment-text').text();comment=comment.length>25?comment.substring(0,25)+'...':comment;var author=$(this).parents('div[id^=comment-]').find('.wc-comment-author').text();commentAuthor=author.length<=25?author:author.substring(0,25)+'...';$('.wpdiscuz-fem-msg').val('');$('.wpdiscuz-fem-email-form').find('em').empty();$('.wpdiscuz-fem-email-form').find('em').text(commentAuthor);$('.wpdiscuz-fem-email').show();$('.wpdiscuz-fem-email-form').show();});$(document).delegate('.wpdiscuz-fem-send','click',function(){message=$('.wpdiscuz-fem-msg').val();subject=$('.wpdiscuz-fem-subj').val();if(''!==message){$('.wpdiscuz-loading-bar').show();$('.wpdiscuz-fem-email-form').children('#wpdiscuz-fem-not').remove();ajaxData={commentID:commentID,action:'wfem_email',subject:subject,message:message};var ajaxObj=ajaxFunction(ajaxData);ajaxObj.done(function(response){$('#wpdiscuz-fem-not').remove();$('.wpdiscuz-fem-email').show();$('.wpdiscuz-fem-email-form').hide();$('.wpdiscuz-fem-response').remove();$('.wpdiscuz-fem-email').append(response);$('.wpdiscuz-loading-bar').hide();});}else{$('.wpdiscuz-fem-email-form').children('#wpdiscuz-fem-not').remove();$('.wpdiscuz-fem-email-form').append('<div id="wpdiscuz-fem-not">Please fill out the field</div>');}});$(document).delegate('.wpdiscuz-fem-moving, .wpdiscuz-fem-email, .fa-times, .wpdiscuz-fem-ok','click',function(){$('.wpdiscuz-fem-response, #wpdiscuz-fem-not').remove();$('.wpdiscuz-fem-moving, .wpdiscuz-fem-move-form, .wpdiscuz-fem-email-form, .wpdiscuz-fem-posts, .wpdiscuz-fem-email, .wpdiscuz-fem-posts, .wpdiscuz-loading-bar').hide();moveToPost=0;$('.wpdiscuz-fem-email-form, .wpdiscuz-fem-move-form').children('#wpdiscuz-fem-not').remove();$('.wpdiscuz-fem-email-form').find('em').empty();$('.wpdiscuz-fem-msg, .wpdiscuz-fem-subj, .wpdiscuz-fem-post').val('');});});